<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:ios="clr-namespace:Microsoft.Maui.Controls.PlatformConfiguration.iOSSpecific;assembly=Microsoft.Maui.Controls"
             x:Class="ioscado.MainPage"
             BackgroundColor="Black"
             ios:Page.UseSafeArea="True"
             Title="">

    <Grid>
        <BoxView IsVisible="True" Opacity="0.6">
            <BoxView.Background>
                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                    <GradientStop Color="#0f172a" Offset="0.0" />
                    <GradientStop Color="#000000" Offset="0.5" />
                    <GradientStop Color="#1e1e1e" Offset="1.0" />
                </LinearGradientBrush>
            </BoxView.Background>
        </BoxView>

        <Grid RowDefinitions="Auto, Auto, Auto, *" Padding="16,0,16,0" RowSpacing="15">

            <Grid Grid.Row="0" ColumnDefinitions="*, Auto" HeightRequest="40" Margin="0,5,0,0">
                <Label Text="SCOUT AI" 
                       TextColor="White" 
                       FontSize="26" 
                       FontAttributes="Bold" 
                       VerticalOptions="Center"
                       FontFamily="Helvetica Neue"/>

                <Border Grid.Column="1" Stroke="#333" BackgroundColor="#222" StrokeShape="RoundRectangle 8" Padding="10,5" VerticalOptions="Center">
                    <Label Text="PRO v26.0" TextColor="#4ade80" FontSize="12" FontAttributes="Bold"/>
                </Border>
            </Grid>

            <Grid Grid.Row="1" ColumnDefinitions="*, *" ColumnSpacing="12" HeightRequest="55">
                <Button x:Name="btnNhapDuLieu"
                        Grid.Column="0"
                        Text="SCAN DATA"
                        Clicked="OnNhapDuLieuClicked"
                        TextColor="White"
                        FontAttributes="Bold"
                        FontSize="14"
                        CornerRadius="12"
                        BorderWidth="0"
                        HeightRequest="55">
                    <Button.Background>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                            <GradientStop Color="#2563eb" Offset="0.0"/>
                            <GradientStop Color="#3b82f6" Offset="1.0"/>
                        </LinearGradientBrush>
                    </Button.Background>
                </Button>

                <Button Grid.Column="1"
                        Text="VERDICT"
                        Clicked="OnPromptKetHopClicked"
                        TextColor="#000000"
                        FontAttributes="Bold"
                        FontSize="14"
                        CornerRadius="12"
                        BorderWidth="0"
                        HeightRequest="55">
                    <Button.Background>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                            <GradientStop Color="#22c55e" Offset="0.0"/>
                            <GradientStop Color="#4ade80" Offset="1.0"/>
                        </LinearGradientBrush>
                    </Button.Background>
                </Button>
            </Grid>

            <Border Grid.Row="2" Stroke="#333" StrokeThickness="1" BackgroundColor="#111" StrokeShape="RoundRectangle 12" HeightRequest="50" Padding="2">
                <Grid ColumnDefinitions="*, *, *">
                    <Grid Grid.Column="0">
                        <BoxView x:Name="bgTab1" Color="#2563eb" CornerRadius="10" IsVisible="True"/>
                        <Label Text="THINK" TextColor="White" FontSize="13" FontAttributes="Bold" HorizontalOptions="Center" VerticalOptions="Center"/>
                        <Button BackgroundColor="Transparent" Clicked="OnTabClicked" CommandParameter="1"/>
                    </Grid>

                    <Grid Grid.Column="1">
                        <BoxView x:Name="bgTab2" Color="Transparent" CornerRadius="10" IsVisible="False"/>
                        <Label Text="SCORE" TextColor="White" FontSize="13" FontAttributes="Bold" HorizontalOptions="Center" VerticalOptions="Center"/>
                        <Button BackgroundColor="Transparent" Clicked="OnTabClicked" CommandParameter="2"/>
                    </Grid>

                    <Grid Grid.Column="2">
                        <BoxView x:Name="bgTab3" Color="Transparent" CornerRadius="10" IsVisible="False"/>
                        <Label Text="SCOUT" TextColor="White" FontSize="13" FontAttributes="Bold" HorizontalOptions="Center" VerticalOptions="Center"/>
                        <Button BackgroundColor="Transparent" Clicked="OnTabClicked" CommandParameter="3"/>
                    </Grid>
                </Grid>
            </Border>

            <CollectionView x:Name="MatchList" Grid.Row="3" SelectionMode="None">
                <CollectionView.ItemsLayout>
                    <LinearItemsLayout Orientation="Vertical" ItemSpacing="12"/>
                </CollectionView.ItemsLayout>

                <CollectionView.Footer>
                    <BoxView HeightRequest="80" Color="Transparent"/>
                </CollectionView.Footer>

                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Border StrokeThickness="0" StrokeShape="RoundRectangle 16" BackgroundColor="{Binding RowBackgroundColor}" HeightRequest="85">
                            <Grid ColumnDefinitions="6, 65, *, 70">

                                <BoxView Grid.Column="0" Color="{Binding LeagueColor}" VerticalOptions="Fill"/>

                                <StackLayout Grid.Column="1" VerticalOptions="Center" HorizontalOptions="Center" Spacing="2">
                                    <Label Text="{Binding DisplayTime}" TextColor="#3b82f6" FontSize="14" FontAttributes="Bold" HorizontalTextAlignment="Center"/>
                                </StackLayout>

                                <StackLayout Grid.Column="2" VerticalOptions="Center" Padding="10,0" Spacing="4">
                                    <Label Text="{Binding LeagueName}" TextColor="#9ca3af" FontSize="11" TextTransform="Uppercase" FontAttributes="Bold" LineBreakMode="TailTruncation"/>
                                    <Label Text="{Binding MatchTitle}" TextColor="White" FontSize="15" FontAttributes="Bold" MaxLines="2" LineBreakMode="TailTruncation"/>
                                </StackLayout>

                                <StackLayout Grid.Column="3" VerticalOptions="Center" HorizontalOptions="Center" Spacing="5">
                                    <Button Text="COPY"
                                            FontSize="11"
                                            FontAttributes="Bold"
                                            HeightRequest="32"
                                            WidthRequest="60"
                                            CornerRadius="16"
                                            BackgroundColor="#334155"
                                            TextColor="White"
                                            Padding="0"
                                            Clicked="OnSaoChepClicked"
                                            CommandParameter="{Binding .}"/>

                                    <Border BackgroundColor="#0f172a" Stroke="#334155" StrokeThickness="1" StrokeShape="RoundRectangle 10" Padding="6,2" HorizontalOptions="Center">
                                        <Label Text="{Binding BlvCount, StringFormat='{0} BLV'}" TextColor="#94a3b8" FontSize="9" FontAttributes="Bold"/>
                                    </Border>
                                </StackLayout>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </Grid>

        <Border x:Name="ToastMessage"
                Grid.RowSpan="4"
                VerticalOptions="End" 
                HorizontalOptions="Center"
                Margin="0,0,0,100"
                BackgroundColor="#333"
                Stroke="#4ade80"
                StrokeThickness="1"
                StrokeShape="RoundRectangle 20"
                Padding="20,10"
                Opacity="0"
                InputTransparent="True">
            <Label x:Name="ToastText" Text="Đã copy thành công!" TextColor="White" FontAttributes="Bold"/>
        </Border>
    </Grid>
</ContentPage>